-- [[ üíÄ SANS COMPLETE CORE (OUTFIT FIX - ADD ONLY) üíÄ ]]

local player = game:GetService("Players").LocalPlayer
local RunService = game:GetService("RunService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local TweenService = game:GetService("TweenService")
local Debris = game:GetService("Debris")

-- === [ ‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏™‡∏µ‡∏¢‡∏á ] ===
local MAIN_MUSIC = "129858762838377" 

local function PlayMusic(id) 
    pcall(function() workspace.DRadio_Script.Event:FireServer(tostring(id)) end)
end

-- === [ ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏≥‡∏û‡∏π‡∏î ] ===
local sansQuotes = {
    "‡∏Ç‡∏∂‡πâ‡∏ô‡∏£‡∏ñ‡∏Å‡∏±‡∏ö‡∏≠‡πâ‡∏≤‡∏¢‡∏ö‡πà‡∏ô‡πâ‡∏≠‡∏á‡∏™‡∏≤‡∏ß",
    "‡∏°‡∏≤‡πÄ‡∏î‡πâ‡∏≠‡∏≠‡πâ‡∏≤‡∏¢‡∏Ç‡∏±‡∏ö‡∏£‡∏ñ‡∏ö‡∏¥‡πâ‡∏Å‡πÑ‡∏ö",
    "‡∏°‡∏≤‡∏Ç‡∏µ‡πà‡∏£‡∏ñ‡∏Å‡∏±‡∏ö‡∏≠‡πâ‡∏≤‡∏¢‡∏°‡∏≤",
    "‡∏≠‡πâ‡∏≤‡∏¢‡∏Å‡∏∞‡∏£‡∏ß‡∏¢‡∏ô‡πâ‡∏≠",
    "‡∏≠‡πâ‡∏≤‡∏¢‡∏°‡∏≤‡∏Ç‡∏≤‡∏¢‡∏Ñ‡πç‡∏≤‡∏ö‡πà‡πÑ‡∏î‡πâ‡∏°‡∏≤‡∏Ç‡∏≤‡∏¢‡∏°‡πâ‡∏≤"
}

-- === [ ‡∏£‡∏∞‡∏ö‡∏ö NameTag ‡∏™‡∏µ‡∏£‡∏∏‡πâ‡∏á ] ===
local currentDisplayText = "SANS"

task.spawn(function()
    local hue = 0
    while true do
        hue = hue + 0.01
        local rainbowColor = Color3.fromHSV(hue % 1, 0.7, 1)
        pcall(function()
            game:GetService("ReplicatedStorage").NameTagRemoteEvent:FireServer(currentDisplayText, rainbowColor, 13)
        end)
        task.wait(0.05)
    end
end)

local function SansSpeak(text)
    local chosenText = text or sansQuotes[math.random(1, #sansQuotes)]
    local fullText = tostring(chosenText)
    for i = 1, #fullText do
        currentDisplayText = string.sub(fullText, 1, i)
        task.wait(0.05)
    end
end

-- === [ ‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ä‡∏∏‡∏î (‡πÉ‡∏™‡πà‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÅ‡∏Ñ‡πà‡πÑ‡∏≠‡πÄ‡∏ó‡∏° Sans ‡∏ä‡∏¥‡πâ‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß) ] ===
local function applyOutfitWithOriginal()
    local character = player.Character or player.CharacterAdded:Wait()
    local humanoid = character:WaitForChild("Humanoid")
    local BloxbizRemotes = ReplicatedStorage:WaitForChild("BloxbizRemotes", 5)
    
    if not BloxbizRemotes then return end
    local BloxRemote = BloxbizRemotes:WaitForChild("CatalogOnApplyOutfit")

    -- ‡∏î‡∏∂‡∏á‡∏ä‡∏∏‡∏î‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô (‡∏£‡∏ß‡∏°‡∏ú‡∏° ‡∏´‡∏°‡∏ß‡∏Å ‡πÅ‡∏•‡∏∞‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏ú‡πâ‡∏≤)
    local desc = humanoid:GetAppliedDescription()
    local currentAccessories = {}
    
    -- ‡πÄ‡∏Å‡πá‡∏ö Accessory ‡πÄ‡∏î‡∏¥‡∏°‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô‡πÑ‡∏ß‡πâ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
    for _, acc in pairs(desc:GetAccessories(false)) do
        table.insert(currentAccessories, {
            ["AssetId"] = acc.AssetId,
            ["AccessoryType"] = acc.AccessoryType,
            ["IsLayered"] = acc.IsLayered or false
        })
    end

    -- ‡πÉ‡∏™‡πà‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÅ‡∏Ñ‡πà‡πÑ‡∏≠‡πÄ‡∏ó‡∏° Sans ‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡πÉ‡∏ô‡∏•‡∏¥‡∏™‡∏ï‡πå
    table.insert(currentAccessories, {
        ["AssetId"] = 18280123011, 
        ["AccessoryType"] = Enum.AccessoryType.Waist,
        ["IsLayered"] = false
    })

    -- ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ä‡∏∏‡∏î‡πÉ‡∏´‡∏°‡πà‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ‡∏ó‡∏∏‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏° 100%
    local outfitData = {
        ["Accessories"] = currentAccessories,
        ["Shirt"] = desc.Shirt,
        ["Pants"] = desc.Pants,
        ["GraphicTShirt"] = desc.GraphicTShirt,
        ["Face"] = desc.Face,
        ["Head"] = desc.Head,
        ["Torso"] = desc.Torso,
        ["LeftArm"] = desc.LeftArm,
        ["RightArm"] = desc.RightArm,
        ["LeftLeg"] = desc.LeftLeg,
        ["RightLeg"] = desc.RightLeg,
        ["HeadColor"] = desc.HeadColor,
        ["TorsoColor"] = desc.TorsoColor,
        ["LeftArmColor"] = desc.LeftArmColor,
        ["RightArmColor"] = desc.RightArmColor,
        ["LeftLegColor"] = desc.LeftLegColor,
        ["RightLegColor"] = desc.RightLegColor,
        ["HeightScale"] = desc.HeightScale,
        ["WidthScale"] = desc.WidthScale,
        ["DepthScale"] = desc.DepthScale,
        ["HeadScale"] = desc.HeadScale,
        ["ProportionScale"] = desc.ProportionScale,
        ["BodyTypeScale"] = desc.BodyTypeScale
    }

    BloxRemote:FireServer(outfitData)
end

-- === [ ‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡πà‡∏≤‡∏ó‡∏≤‡∏á‡πÅ‡∏•‡∏∞‡πÅ‡∏≠‡∏ô‡∏¥‡πÄ‡∏°‡∏ä‡∏±‡πà‡∏ô ] ===
function RunCustomAnimation(Char)
    if not Char then return end
    local Humanoid = Char:WaitForChild("Humanoid", 10)
    local HRP = Char:WaitForChild("HumanoidRootPart", 10)
    
    if Char:FindFirstChild("Animate") then Char.Animate.Disabled = true end

    local currentAnimTrack = nil
    local lastState = "Idle"

    local animTable = {}    
    local animNames = { 
        spawn = {{id = "rbxassetid://90183548743095"}}, 
        idle = {{id = "rbxassetid://105849712838745"}},  
        move = {{id = "rbxassetid://130974202308081"}}
    }

    for name, fileList in pairs(animNames) do
        animTable[name] = {count = 0}
        for idx, anim in pairs(fileList) do
            animTable[name][idx] = {anim = Instance.new("Animation")}
            animTable[name][idx].anim.AnimationId = anim.id
            animTable[name].count += 1
        end
    end

    local function playAnim(name, loop, speed)
        if not animTable[name] or not Humanoid then return end
        if currentAnimTrack then currentAnimTrack:Stop(0.1) end
        local idx = math.random(1, animTable[name].count)
        currentAnimTrack = Humanoid:LoadAnimation(animTable[name][idx].anim)
        currentAnimTrack.Looped = loop
        currentAnimTrack:Play(0.1)
        if speed then currentAnimTrack:AdjustSpeed(speed) end
        return currentAnimTrack
    end

    Humanoid.Running:Connect(function(speed)
        if speed > 2 then 
            if lastState ~= "Moving" then 
                lastState = "Moving" 
                playAnim("move", true, 1.4)
                PlayMusic("98812161953798")
            end
        else 
            if lastState ~= "Idle" then 
                lastState = "Idle" 
                playAnim("idle", true)
                PlayMusic(MAIN_MUSIC)
            end 
        end
    end)

    task.spawn(function()
        HRP.Anchored = true
        PlayMusic("1060573050") 
        local st = playAnim("spawn", false)
        if st then st.Ended:Wait() end
        HRP.Anchored = false
        playAnim("idle", true)
        task.spawn(function() SansSpeak() end)
        PlayMusic(MAIN_MUSIC)
    end)
end

-- === [ ‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô ] ===
if player.Character then
    task.spawn(function() RunCustomAnimation(player.Character) end)
    applyOutfitWithOriginal()
end

player.CharacterAdded:Connect(function(char)
    task.spawn(function() RunCustomAnimation(char) end)
    task.wait(2) 
    applyOutfitWithOriginal()
end)
